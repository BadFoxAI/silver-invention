<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>A-Frame Ammo Physics (Guide v4.2.3)</title> <!-- Updated Title -->
    <meta name="description" content="A-Frame Physics World using Ammo.js driver - Following Official Guide">

    <!-- A-Frame Library (Using latest stable 1.5.0) -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

    <!-- === Physics Scripts (Correct Order & Versions FROM USER GUIDE) === -->
    <!-- 1. Load Recommended Ammo.js Fork FIRST -->
    <script src="https://cdn.jsdelivr.net/gh/MozillaReality/ammo.js@8bbc0ea/builds/ammo.wasm.js"></script>
    <!-- 2. Load Correct aframe-physics-system AFTER Ammo -->
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.3/dist/aframe-physics-system.js"></script>
    <!-- === End Physics Scripts === -->

    <!-- A-Frame Environment Component -->
    <script src="https://unpkg.com/aframe-environment-component@1.3.9/dist/aframe-environment-component.min.js"></script>

</head>
<body>
    <!-- Enable physics using AMMO driver and debug -->
    <!-- Using physics settings from the guide -->
    <a-scene physics="driver: ammo; debug: true; debugDrawMode: 1; gravity: -9.8;">

        <!-- Assets Management System -->
        <a-assets>
            <a-mixin id="wood" material="color: #A0522D; roughness: 0.8;"></a-mixin>
            <a-mixin id="stone" material="color: #808080; roughness: 0.7;"></a-mixin>
            <a-mixin id="metal" material="color: #FFD700; metalness: 0.6; roughness: 0.4;"></a-mixin>
        </a-assets>

        <!-- Environment Component -->
        <!-- Added Ammo attributes for static ground physics -->
        <a-entity environment="preset: forest; ground: hills; groundYScale: 3; groundTexture: walkernoise; groundColor: #524439; groundColor2: #695748; dressing: trees; dressingAmount: 30; dressingScale: 3; fog: 0.8; shadow: true;"
                  ammo-body="type: static;"
                  ammo-shape="type: box;"> <!-- Approximating hill ground as box -->
        </a-entity>

        <!-- Player Rig -->
        <a-entity id="player"
                  position="0 10 8" <!-- Start high -->
                  wasd-controls="acceleration: 80"
                  <!-- ammo-body uses default dynamic type if not specified -->
                  ammo-body="mass: 70; linearDamping: 0.95; angularFactor: 0 0 0;" <!-- Specify properties -->
                  <!-- Capsule shape requires fit: manual -->
                  ammo-shape="type: capsule; fit: manual; height: 1.6; radius: 0.3;">
            <a-camera look-controls="pointerLockEnabled: true">
                <a-cursor scale="0.5 0.5 0.5" color="#FFF" opacity="0.5"></a-cursor>
            </a-camera>
        </a-entity>

        <!-- Dynamic Objects (Using Ammo attributes) -->
        <a-box mixin="wood" position="-3 15 -5" rotation="10 30 5" width="1.5" height="1.5" depth="1.5" shadow="cast: true"
               ammo-body="type: dynamic; mass: 10;" ammo-shape="type: box;">
        </a-box>
        <a-box mixin="wood" position="-4 18 -5.5" rotation="-5 10 20" width="1.5" height="1.5" depth="1.5" shadow="cast: true"
               ammo-body="type: dynamic; mass: 10;" ammo-shape="type: box;">
        </a-box>
        <a-sphere mixin="stone" position="2 12 -6" radius="1.2" shadow="cast: true"
                  ammo-body="type: dynamic; mass: 50; angularDamping: 0.1;" ammo-shape="type: sphere;">
        </a-sphere>
        <a-sphere mixin="stone" position="3 16 -7" radius="0.8" shadow="cast: true"
                  ammo-body="type: dynamic; mass: 20; angularDamping: 0.1;" ammo-shape="type: sphere;">
        </a-sphere>
        <a-cylinder mixin="stone" position="5 10 -4" radius="0.7" height="4" shadow="cast: true"
                    ammo-body="type: dynamic; mass: 80;" ammo-shape="type: cylinder;">
        </a-cylinder>
        <a-torus mixin="metal" position="-6 20 -8" radius="1.5" radius-tubular="0.3" rotation="30 45 10" shadow="cast: true"
                 ammo-body="type: dynamic; mass: 5;" ammo-shape="type: cylinder;"> <!-- Approx -->
        </a-torus>

        <!-- Static Platforms -->
        <a-box mixin="stone" position="0 2.5 -10" width="6" height="5" depth="1" shadow="receive: true; cast: true;"
               ammo-body="type: static;" ammo-shape="type: box;">
        </a-box>
        <a-box mixin="stone" position="-3 0.25 -8" width="1" height="0.5" depth="4" shadow="receive: true; cast: true;"
               ammo-body="type: static;" ammo-shape="type: box;">
        </a-box>
        <a-box mixin="stone" position="3 0.25 -8" width="1" height="0.5" depth="4" shadow="receive: true; cast: true;"
               ammo-body="type: static;" ammo-shape="type: box;">
        </a-box>
        <a-box mixin="wood" position="0 0.7 -6" rotation="0 0 -20" width="3" height="0.3" depth="3" shadow="receive: true; cast: true;"
               ammo-body="type: static;" ammo-shape="type: box;"> <!-- Ramp -->
        </a-box>

    </a-scene>
</body>
</html>
